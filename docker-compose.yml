services:
  librarydownloadarr:
    build: .
    container_name: librarydownloadarr
    restart: unless-stopped
    ports:
      - "5069:5069"
    environment:
      # Server configuration
      - PORT=5069
      - LOG_LEVEL=debug
      # Database path (persisted to volume)
      - DATABASE_PATH=/app/data/librarydownloadarr.db
      # Transcode directory (for transcoded files, cached for 1 week)
      # IMPORTANT: Mount a fast drive for better transcoding performance
      - TRANSCODE_DIR=/app/transcode
      # Maximum number of concurrent transcodes (default: 2)
      - MAX_CONCURRENT_TRANSCODES=2
      # Hardware encoding: auto (detect), vaapi, qsv, or software (disable)
      - HARDWARE_ENCODING=auto
      # Timezone configuration (set to your local timezone)
      - TZ=America/New_York
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
      # Mount your transcode directory - use a fast drive for best performance
      # Files are kept for 1 week after transcoding completes
      # Example: /mnt/SSD/transcode:/app/transcode
      - ./transcode:/app/transcode
    # GPU access for hardware encoding (Intel QSV / AMD VAAPI)
    devices:
      - /dev/dri:/dev/dri
    group_add:
      - "44"    # video group
      - "993"   # render group
    networks:
      - librarydownloadarr

networks:
  librarydownloadarr:
    driver: bridge
